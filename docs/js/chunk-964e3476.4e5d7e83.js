(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-964e3476"],{1276:function(e,a,t){"use strict";var n=t("2ba4"),o=t("c65b"),l=t("e330"),r=t("d784"),i=t("44e7"),u=t("825a"),c=t("1d80"),s=t("4840"),b=t("8aa5"),f=t("50c4"),p=t("577e"),d=t("dc4a"),h=t("4dae"),v=t("14c3"),g=t("9263"),k=t("9f7f"),m=t("d039"),I=k.UNSUPPORTED_Y,w=4294967295,B=Math.min,y=[].push,x=l(/./.exec),O=l(y),C=l("".slice),S=!m((function(){var e=/(?:)/,a=e.exec;e.exec=function(){return a.apply(this,arguments)};var t="ab".split(e);return 2!==t.length||"a"!==t[0]||"b"!==t[1]}));r("split",(function(e,a,t){var l;return l="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var l=p(c(this)),r=void 0===t?w:t>>>0;if(0===r)return[];if(void 0===e)return[l];if(!i(e))return o(a,l,e,r);var u,s,b,f=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),v=0,k=new RegExp(e.source,d+"g");while(u=o(g,k,l)){if(s=k.lastIndex,s>v&&(O(f,C(l,v,u.index)),u.length>1&&u.index<l.length&&n(y,f,h(u,1)),b=u[0].length,v=s,f.length>=r))break;k.lastIndex===u.index&&k.lastIndex++}return v===l.length?!b&&x(k,"")||O(f,""):O(f,C(l,v)),f.length>r?h(f,0,r):f}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:o(a,this,e,t)}:a,[function(a,t){var n=c(this),r=void 0==a?void 0:d(a,e);return r?o(r,a,n,t):o(l,p(n),a,t)},function(e,n){var o=u(this),r=p(e),i=t(l,o,r,n,l!==a);if(i.done)return i.value;var c=s(o,RegExp),d=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(I?"g":"y"),g=new c(I?"^(?:"+o.source+")":o,h),k=void 0===n?w:n>>>0;if(0===k)return[];if(0===r.length)return null===v(g,r)?[r]:[];var m=0,y=0,x=[];while(y<r.length){g.lastIndex=I?0:y;var S,N=v(g,I?C(r,y):r);if(null===N||(S=B(f(g.lastIndex+(I?y:0)),r.length))===m)y=b(r,y,d);else{if(O(x,C(r,m,y)),x.length===k)return x;for(var _=1;_<=N.length-1;_++)if(O(x,N[_]),x.length===k)return x;y=m=S}}return O(x,C(r,m)),x}]}),!S,I)},"14c3":function(e,a,t){var n=t("da84"),o=t("c65b"),l=t("825a"),r=t("1626"),i=t("c6b6"),u=t("9263"),c=n.TypeError;e.exports=function(e,a){var t=e.exec;if(r(t)){var n=o(t,e,a);return null!==n&&l(n),n}if("RegExp"===i(e))return o(u,e,a);throw c("RegExp#exec called on incompatible receiver")}},"159b":function(e,a,t){var n=t("da84"),o=t("fdbc"),l=t("785a"),r=t("17c2"),i=t("9112"),u=function(e){if(e&&e.forEach!==r)try{i(e,"forEach",r)}catch(a){e.forEach=r}};for(var c in o)o[c]&&u(n[c]&&n[c].prototype);u(l)},"17c2":function(e,a,t){"use strict";var n=t("b727").forEach,o=t("a640"),l=o("forEach");e.exports=l?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},"25f0":function(e,a,t){"use strict";var n=t("e330"),o=t("5e77").PROPER,l=t("6eeb"),r=t("825a"),i=t("3a9b"),u=t("577e"),c=t("d039"),s=t("ad6d"),b="toString",f=RegExp.prototype,p=f[b],d=n(s),h=c((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),v=o&&p.name!=b;(h||v)&&l(RegExp.prototype,b,(function(){var e=r(this),a=u(e.source),t=e.flags,n=u(void 0===t&&i(f,e)&&!("flags"in f)?d(e):t);return"/"+a+"/"+n}),{unsafe:!0})},"44e7":function(e,a,t){var n=t("861d"),o=t("c6b6"),l=t("b622"),r=l("match");e.exports=function(e){var a;return n(e)&&(void 0!==(a=e[r])?!!a:"RegExp"==o(e))}},"4de4":function(e,a,t){"use strict";var n=t("23e7"),o=t("b727").filter,l=t("1dde"),r=l("filter");n({target:"Array",proto:!0,forced:!r},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,a,t){"use strict";t.d(a,"a",(function(){return l}));t("b64b"),t("a4d3"),t("4de4"),t("d3b7"),t("e439"),t("159b"),t("dbb4");function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}},"8aa5":function(e,a,t){"use strict";var n=t("6547").charAt;e.exports=function(e,a,t){return a+(t?n(e,a).length:1)}},a594:function(e,a,t){},a640:function(e,a,t){"use strict";var n=t("d039");e.exports=function(e,a){var t=[][e];return!!t&&n((function(){t.call(null,a||function(){throw 1},1)}))}},b64b:function(e,a,t){var n=t("23e7"),o=t("7b0b"),l=t("df75"),r=t("d039"),i=r((function(){l(1)}));n({target:"Object",stat:!0,forced:i},{keys:function(e){return l(o(e))}})},d784:function(e,a,t){"use strict";t("ac1f");var n=t("e330"),o=t("6eeb"),l=t("9263"),r=t("d039"),i=t("b622"),u=t("9112"),c=i("species"),s=RegExp.prototype;e.exports=function(e,a,t,b){var f=i(e),p=!r((function(){var a={};return a[f]=function(){return 7},7!=""[e](a)})),d=p&&!r((function(){var a=!1,t=/a/;return"split"===e&&(t={},t.constructor={},t.constructor[c]=function(){return t},t.flags="",t[f]=/./[f]),t.exec=function(){return a=!0,null},t[f](""),!a}));if(!p||!d||t){var h=n(/./[f]),v=a(f,""[e],(function(e,a,t,o,r){var i=n(e),u=a.exec;return u===l||u===s.exec?p&&!r?{done:!0,value:h(a,t,o)}:{done:!0,value:i(t,a,o)}:{done:!1}}));o(String.prototype,e,v[0]),o(s,f,v[1])}b&&u(s[f],"sham",!0)}},dbb4:function(e,a,t){var n=t("23e7"),o=t("83ab"),l=t("56ef"),r=t("fc6a"),i=t("06cf"),u=t("8418");n({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){var a,t,n=r(e),o=i.f,c=l(n),s={},b=0;while(c.length>b)t=o(n,a=c[b++]),void 0!==t&&u(s,a,t);return s}})},e439:function(e,a,t){var n=t("23e7"),o=t("d039"),l=t("fc6a"),r=t("06cf").f,i=t("83ab"),u=o((function(){r(1)})),c=!i||u;n({target:"Object",stat:!0,forced:c,sham:!i},{getOwnPropertyDescriptor:function(e,a){return r(l(e),a)}})},e81a:function(e,a,t){"use strict";a["a"]={options:[{value:"A",label:"A马克思主义、列宁主义、毛泽东思想、邓小平理论",children:[{value:"A",label:"全部"},{value:"A1",label:"A1马克思、恩格斯著作"},{value:"A2",label:"A2毛泽东著作"},{value:"A3",label:"A3马克思主义、列宁主义、毛泽东思想、邓小平理论的学习和研究"}]},{value:"B",label:"B哲学、宗教",children:[{value:"B",label:"全部"},{value:"B0",label:"B0哲学理论"},{value:"B81",label:"B81逻辑学"},{value:"B84",label:"B84心理学"}]},{value:"C",label:"C社会科学总论",children:[{value:"C",label:"全部"},{value:"C0",label:"C0社会科学理论与方法论"},{value:"C91",label:"C91社会学"},{value:"C8",label:"C8统计学"},{value:"C93",label:"C93管理学"}]},{value:"D",label:"D政治、法律",children:[{value:"D",label:"全部"},{value:"D2",label:"D2中国共产党"},{value:"D8",label:"D8外交、国际关系"},{value:"D9",label:"D9法律"}]},{value:"E",label:"E军事",children:[{value:"E",label:"全部"},{value:"E0",label:"E0军事理论"},{value:"E2",label:"E2中国军事"}]},{value:"F",label:"F经济",children:[{value:"F",label:"全部"},{value:"F0",label:"F0经济学"},{value:"F8",label:"F8财政、金融"}]},{value:"G",label:"G文化、科学、教育、体育",children:[{value:"G",label:"全部"},{value:"G4",label:"G4教育"},{value:"",label:"G8体育"}]},{value:"H",label:"H语言、文字",children:[{value:"H",label:"全部"},{value:"H0",label:"H0语言学"},{value:"H1",label:"H1汉语"},{value:"H3",label:"H3常用外国语"}]},{value:"I",label:"I文学",children:[{value:"I",label:"全部"},{value:"I1",label:"I1世界文学"},{value:"I2",label:"I2中国文学"}]},{value:"J",label:"J艺术",children:[{value:"J",label:"全部"},{value:"J2",label:"J2绘画"},{value:"J9",label:"J9电影、电视艺术"}]},{value:"K",label:"K历史、地理",children:[{value:"K",label:"全部"},{value:"K1",label:"K1世界史"},{value:"K2",label:"K2中国史"},{value:"K9",label:"K9地理"}]},{value:"N",label:"N自然科学总论",children:[{value:"N",label:"全部"},{value:"N0",label:"N0自然科学理论与方法论"}]},{value:"O",label:"O数理科学和化学",children:[{value:"O",label:"全部"},{value:"O1",label:"O1数学"},{value:"O4",label:"O4物理学"},{value:"O6",label:"O6化学"}]},{value:"P",label:"P天文学、地球科学",children:[{value:"P",label:"全部"},{value:"P1",label:"P1天文学"},{value:"P9",label:"P9自然地理学"}]},{value:"Q",label:"Q生物科学",children:[{value:"Q",label:"全部"},{value:"Q2",label:"Q2细胞生物学"},{value:"Q4",label:"Q4遗传学"},{value:"Q94",label:"Q94植物学"}]},{value:"R",label:"R医药、卫生",children:[{value:"R",label:"全部"},{value:"R3",label:"R3基础医学"},{value:"R4",label:"R4临床医学"},{value:"R9",label:"R9药学"}]},{value:"S",label:"S农业科学",children:[{value:"S",label:"全部"},{value:"S1",label:"S1农业基础科学"},{value:"S6",label:"S6园艺"}]},{value:"T",label:"T工业技术",children:[{value:"T",label:"全部"},{value:"TB",label:"TB一般工业技术"},{value:"TN",label:"TN无线电电子学、电信技术"},{value:"TP",label:"TP自动化技术、计算机技术"}]},{value:"U",label:"U交通运输",children:[{value:"U",label:"全部"},{value:"U2",label:"U2铁路运输"},{value:"U4",label:"U4公路运输"},{value:"U6",label:"U6水路运输"}]},{value:"V",label:"V航空、航天",children:[{value:"V",label:"全部"},{value:"V2",label:"V2航空"},{value:"V4",label:"V4航天"}]},{value:"X",label:"X环境科学、安全科学",children:[{value:"X",label:"全部"},{value:"X1",label:"X1环境科学基础理论"},{value:"X3",label:"X3环境保护管理"}]},{value:"Z",label:"Z综合类图书",children:[{value:"Z",label:"全部"}]}]}},f3e4:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1,title:"Add book"}},[e.getBook?t("a-form",[t("a-form-item",{attrs:{label:"cover",labelCol:{span:7},wrapperCol:{span:10}}},[t("a-upload",{staticClass:"avatar-uploader",attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,customRequest:e.upload}},[e.newBookInfo.cover?t("img",{attrs:{src:e.newBookInfo.cover,alt:"avatar"}}):t("div",[t("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(" UPLOAD COVER ")])],1)])],1),t("a-form-item",{attrs:{label:e.bookName,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-input",{attrs:{placeholder:e.bookNameInput},model:{value:e.newBookInfo.book_name,callback:function(a){e.$set(e.newBookInfo,"book_name",a)},expression:"newBookInfo.book_name"}})],1),t("a-form-item",{attrs:{label:e.author,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-input",{attrs:{placeholder:e.authorInput},model:{value:e.newBookInfo.author,callback:function(a){e.$set(e.newBookInfo,"author",a)},expression:"newBookInfo.author"}})],1),t("a-form-item",{attrs:{label:e.publisher,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-input",{attrs:{placeholder:e.publisherInput},model:{value:e.newBookInfo.publisher,callback:function(a){e.$set(e.newBookInfo,"publisher",a)},expression:"newBookInfo.publisher"}})],1),t("a-form-item",{attrs:{label:e.ISBN,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-input",{attrs:{placeholder:e.ISBNInput},model:{value:e.newBookInfo.ISBN,callback:function(a){e.$set(e.newBookInfo,"ISBN",a)},expression:"newBookInfo.ISBN"}})],1),t("a-form-item",{attrs:{label:e.publishedTime,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:e.publishedTimeInput},model:{value:e.newBookInfo.published_time,callback:function(a){e.$set(e.newBookInfo,"published_time",a)},expression:"newBookInfo.published_time"}})],1),t("a-form-item",{attrs:{label:e.category,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-cascader",{attrs:{options:e.options,placeholder:e.categoryInput,"show-search":{filter:e.filter}},model:{value:e.newBookInfo.category,callback:function(a){e.$set(e.newBookInfo,"category",a)},expression:"newBookInfo.category"}})],1),t("a-form-item",{attrs:{label:e.briefIntroduction,labelCol:{span:7},wrapperCol:{span:10}}},[t("a-textarea",{attrs:{rows:"4",placeholder:e.briefIntroductionInput},model:{value:e.newBookInfo.brief_introduction,callback:function(a){e.$set(e.newBookInfo,"brief_introduction",a)},expression:"newBookInfo.brief_introduction"}})],1),t("a-form-item",{staticStyle:{"margin-top":"24px"},attrs:{wrapperCol:{span:10,offset:7}}},[t("a-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("Add")]),t("a-button",{on:{click:e.cancel}},[e._v("CANCEL")])],1)],1):t("a-form",[t("a-form-item",{attrs:{label:"language",labelCol:{span:7},wrapperCol:{span:10}}},[t("a-select",{attrs:{"default-value":"zh"},on:{change:e.handleChangeLanguage}},[t("a-select-option",{attrs:{value:"en"}},[e._v(" English ")]),t("a-select-option",{attrs:{value:"zh"}},[e._v(" 中文 ")])],1)],1),t("a-form-item",{attrs:{label:"ISBN",labelCol:{span:7},wrapperCol:{span:10}}},[t("a-input",{attrs:{placeholder:e.ISBNInput},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.newBookInfo.ISBN,callback:function(a){e.$set(e.newBookInfo,"ISBN",a)},expression:"newBookInfo.ISBN"}})],1),t("a-form-item",{attrs:{wrapperCol:{span:10,offset:7}}},[t("a-button",{attrs:{type:"primary",loading:e.searching},on:{click:e.search}},[e._v(" GET BOOK INFO ")])],1)],1)],1)},o=[],l=t("1da1"),r=t("5530"),i=(t("96cf"),t("ac1f"),t("1276"),t("d3b7"),t("25f0"),t("e9c4"),t("b0c0"),t("fb6a"),t("a4d3"),t("e01a"),t("93d6")),u=t("e81a"),c=t("c1df"),s=t.n(c);function b(e,a){var t=new FileReader;t.addEventListener("load",(function(){return a(t.result)})),t.readAsDataURL(e)}var f={name:"AddByIsbn",data:function(){return{getBook:!1,searching:!1,loading:!1,bookName:"Book name",bookNameInput:"Please input book name",author:"Author",authorInput:"Please input author",publisher:"Publisher",publisherInput:"Please input publisher",ISBN:"ISBN",ISBNInput:"Please input ISBN",category:"Category",categoryInput:"Please enter or select category",publishedTime:"Publish date",publishedTimeInput:"Please select publish date",briefIntroduction:"Introduction",briefIntroductionInput:"Please input introduction",newBookInfo:{book_name:void 0,author:void 0,publisher:void 0,ISBN:void 0,category:void 0,published_time:void 0,cover:void 0,brief_introduction:void 0},options:u["a"].options,language:"zh"}},created:function(){console.log(s()().format())},methods:{handleUpdate:function(e){var a=this;"uploading"!==e.file.status?"done"===e.file.status&&b(e.file.originFileObj,(function(e){a.newBookInfo.cover=e,a.loading=!1})):this.loading=!0},upload:function(e){var a=this;this.loading=!0;var t=new FileReader;t.readAsDataURL(e.file),t.onloadend=function(e){var t=this,n=e.target.result.toString().split(",")[1];if(e&&e.target&&e.target.result){var o=n,l={method:"POST",body:o};fetch("https://service-rb270dgm-1301774019.gz.apigw.tencentcs.com/release/SPM_uploadimage",l).then((function(e){return e.text()})).then((function(e){t.loading=!1,a.newBookInfo.cover=e,console.log(e)})).catch((function(e){console.log("error",e),a.loading=!1}))}}},submit:function(){var e=Object(r["a"])({},this.newBookInfo);e.category=this.newBookInfo.category[1],e.published_time=e.published_time.format("YYYY-MM")+"-01",console.log(e);var a=new Headers;a.append("token",Object(i["c"])()),a.append("Content-Type","application/json");var t=e,n={method:"POST",headers:a,body:JSON.stringify(t)},o=this;fetch("".concat(this.$global.BASE_URL,"/api/admin/book/add"),n).then((function(e){return e.json()})).then((function(e){0===e.code||"0"===e.code?(o.$message.success("Add book successfully"),o.refresh()):o.$message.error("Failed to add the book.")})).catch((function(e){o.$message.error("API call failed.")}))},filter:function(e,a){return a.some((function(a){return a.label.toLowerCase().indexOf(e.toLowerCase())>-1}))},search:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var t,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("zh"!==e.language){a.next=4;break}return console.log(e.language),e.cnSearch(),a.abrupt("return");case 4:return e.searching=!0,t=e.newBookInfo.ISBN,n={},o=e,a.next=10,fetch("https://openlibrary.org/api/books?bibkeys=ISBN:".concat(t,"&jscmd=details&format=json")).then((function(e){return e.json()})).then((function(e){"{}"===JSON.stringify(e)?(o.$message.error("ISBN not found, please enter another."),o.searching=!1,o.newBookInfo.ISBN=void 0):n=e["ISBN:".concat(t)].details}));case 10:if(e.newBookInfo.book_name=n.title,n.publishers&&(e.newBookInfo.publisher=n.publishers[0]),n.covers&&(e.newBookInfo.cover="https://covers.openlibrary.org/b/id/".concat(n.covers[0],".jpg")),!n.authors){a.next=17;break}e.newBookInfo.author=n.authors[0].name,a.next=19;break;case 17:return a.next=19,fetch("https://openlibrary.org/api/get?key=/authors/".concat(n.works[0].key.split("/")[2].slice(0,-1),"A")).then((function(e){return e.json()})).then((function(e){"fail"==e.status?console.log("fail"):o.newBookInfo.author=e.result.name})).catch((function(e){}));case 19:n.publish_date&&(e.newBookInfo.published_time=s()(n.publish_date,"MMMM DD, YYYY")),fetch("https://openlibrary.org/api/get?key=".concat(n.works[0].key)).then((function(e){return e.json()})).then((function(e){e.result.description?o.newBookInfo.brief_introduction=e.result.description.slice(0,200)+"...":o.newBookInfo.brief_introduction=o.newBookInfo.book_name})),o.newBookInfo.category=["I","I1"],e.$message.success("Got the book."),e.searching=!1,e.getBook=!0;case 25:case"end":return a.stop()}}),a)})))()},cnSearch:function(){var e=this;this.searching=!0;var a=this.newBookInfo.ISBN,t=this;fetch("https://api.jike.xyz/situ/book/isbn/".concat(a,"?apikey=12524.6833bc5d3ba860a9242c196b4feaae26.8da93d6d3ac6f6bc9f2ab633b26cc791")).then((function(e){return e.json()})).then((function(a){var n=a.data,o=a.ret;a.msg;t.searching=!1,1===o?t.$message.error("ISBN not found!"):(t.$message.success("Got the book."),t.newBookInfo.cover=n.photoUrl,t.newBookInfo.book_name=n.name,t.newBookInfo.author=n.author,t.newBookInfo.publisher=n.publishing,t.newBookInfo.published_time=s()(n.published),t.newBookInfo.brief_introduction=n.description.slice(0,200),e.getBook=!0)}))},handleChangeLanguage:function(e){this.language=e},refresh:function(){this.getBook=!1,this.newBookInfo={book_name:void 0,author:void 0,publisher:void 0,ISBN:void 0,category:void 0,published_time:void 0,cover:void 0,brief_introduction:void 0},this.searching=!1},cancel:function(){this.refresh()}}},p=f,d=(t("f69d"),t("2877")),h=Object(d["a"])(p,n,o,!1,null,null,null);a["default"]=h.exports},f69d:function(e,a,t){"use strict";t("a594")}}]);
//# sourceMappingURL=chunk-964e3476.4e5d7e83.js.map