(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bd5c8"],{"2c56":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-table",{attrs:{"data-source":e.borrowingList,rowKey:function(e){return e.borrowing_id},loading:e.loading}},[n("a-table-column",{attrs:{title:"book_name","data-index":"book_name"}}),n("a-table-column",{attrs:{title:"ISBN","data-index":"ISBN"}}),n("a-table-column",{attrs:{title:"borrow_date","data-index":"borrow_date"}}),n("a-table-column",{attrs:{title:"due_date","data-index":"due_date"}}),n("a-table-column",{attrs:{title:"Action"},scopedSlots:e._u([{key:"default",fn:function(t,o){return[n("a-tooltip",{staticClass:"item",attrs:{effect:"dark",size:"small",content:"详情",placement:"top"}},[n("a-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.routeToDetail(o.borrowing_id)}}},[e._v(" 详情 ")])],1),n("a-tooltip",{staticClass:"item",attrs:{effect:"dark",size:"small",content:"归还",placement:"top"}},[n("a-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.returnBook(o.borrowing_id)}}},[e._v(" 归还 ")])],1),n("a-tooltip",{staticClass:"item",attrs:{effect:"dark",size:"small",content:"续借",placement:"top"}},[n("a-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.renewBook(o.borrowing_id)}}},[e._v("续借")])],1)]}}])})],1)],1)},r=[],a=n("1da1"),c=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),{data:function(){return{access_token:"",borrowingList:[],loading:!0}},created:function(){this.getBorrowing()},methods:{getBorrowing:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,o,r,a,c,s,i,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e,n=new Headers,n.append("access_token",e.access_token),o={method:"GET",headers:n},r=new Request("https://www.fastmock.site/mock/54449dce8948f02a106d0f454713f04b/spm/api/usr/borrowing",o),t.next=7,fetch(r).then((function(e){return e.json()})).then((function(e){a=e.borrowings})).catch((function(e){return console.log("Request Failed",e)}));case 7:c=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={method:"GET"},u="https://www.fastmock.site/mock/54449dce8948f02a106d0f454713f04b/spm/api/book/detail?ISBN="+a[t].ISBN,l=new Request(u,i),e.next=5,fetch(l).then((function(e){return e.json()})).then((function(e){a[t].book_name=e.book_info.book_name}));case 5:case"end":return e.stop()}}),e)})),s=0;case 9:if(!(s<a.length)){t.next=14;break}return t.delegateYield(c(s),"t0",11);case 11:s++,t.next=9;break;case 14:e.borrowingList=a,e.loading=!1;case 16:case"end":return t.stop()}}),t)})))()},routeToDetail:function(e){this.$router.push({path:"/user/borrowing/"+e+"/detail",params:{id:e}})},returnBook:function(e){var t=this.$createElement;console.log(e);var n=new Headers;n.append("access_token",this.access_token);var o={method:"POST",body:e,headers:n},r=new Request("https://www.fastmock.site/mock/54449dce8948f02a106d0f454713f04b/spm/api/borrowing/return",o);fetch(r).then((function(e){return e.json()})).then((function(e){console.log(e),0==e.error_code&&t("a-alert",{attrs:{message:"Success Text",type:"success"}})})).catch((function(e){return console.log("Request Failed",e)}))},renewBook:function(e){console.log(e);var t=new Headers;t.append("access_token",this.access_token);var n={method:"POST",body:e,headers:t},o=new Request("https://www.fastmock.site/mock/54449dce8948f02a106d0f454713f04b/spm/api/borrowing/renew",n);fetch(o).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){return console.log("Request Failed",e)}))}}}),s=c,i=n("2877"),u=Object(i["a"])(s,o,r,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0bd5c8.9037b100.js.map