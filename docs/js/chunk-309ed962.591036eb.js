(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-309ed962"],{"0b42":function(e,t,o){var n=o("da84"),r=o("e8b5"),i=o("68ee"),a=o("861d"),c=o("b622"),s=c("species"),u=n.Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,i(t)&&(t===u||r(t.prototype))?t=void 0:a(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?u:t}},"1dde":function(e,t,o){var n=o("d039"),r=o("b622"),i=o("2d00"),a=r("species");e.exports=function(e){return i>=51||!n((function(){var t=[],o=t.constructor={};return o[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"65f0":function(e,t,o){var n=o("0b42");e.exports=function(e,t){return new(n(e))(0===t?0:t)}},8418:function(e,t,o){"use strict";var n=o("a04b"),r=o("9bf2"),i=o("5c6c");e.exports=function(e,t,o){var a=n(t);a in e?r.f(e,a,i(0,o)):e[a]=o}},"99af":function(e,t,o){"use strict";var n=o("23e7"),r=o("da84"),i=o("d039"),a=o("e8b5"),c=o("861d"),s=o("7b0b"),u=o("07fa"),l=o("8418"),d=o("65f0"),p=o("1dde"),b=o("b622"),f=o("2d00"),m=b("isConcatSpreadable"),g=9007199254740991,w="Maximum allowed index exceeded",h=r.TypeError,v=f>=51||!i((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),_=p("concat"),y=function(e){if(!c(e))return!1;var t=e[m];return void 0!==t?!!t:a(e)},k=!v||!_;n({target:"Array",proto:!0,forced:k},{concat:function(e){var t,o,n,r,i,a=s(this),c=d(a,0),p=0;for(t=-1,n=arguments.length;t<n;t++)if(i=-1===t?a:arguments[t],y(i)){if(r=u(i),p+r>g)throw h(w);for(o=0;o<r;o++,p++)o in i&&l(c,p,i[o])}else{if(p>=g)throw h(w);l(c,p++,i)}return c.length=p,c}})},bd35:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-card",{attrs:{title:"Borrowing Info",bordered:!1}},[[o("a-card",{staticStyle:{width:"300px","margin-top":"50px"},attrs:{hoverable:"",bordered:!1},scopedSlots:e._u([{key:"cover",fn:function(){return[o("img",{attrs:{src:e.bookInfo.cover}})]},proxy:!0}])})],[o("a-descriptions",{staticStyle:{"margin-top":"50px"},attrs:{size:"default",bordered:""}},[o("a-descriptions-item",{attrs:{label:"book name "}},[e._v(e._s(this.bookInfo.bookName))]),o("a-descriptions-item",{attrs:{label:"borrowing id"}},[e._v(e._s(e.borrowingDetail.borrowing_id))]),o("a-descriptions-item",{attrs:{label:"ISBN"}},[e._v(e._s(e.borrowingDetail.ISBN))]),o("a-descriptions-item",{attrs:{label:"status"}},[e._v(e._s(e.borrowingDetail.status))]),o("a-descriptions-item",{attrs:{label:"borrow time"}},[e._v(e._s(e.borrowingDetail.borrow_time))]),o("a-descriptions-item",{attrs:{label:"due time"}},[e._v(e._s(e.borrowingDetail.due_time))]),o("a-descriptions-item",{attrs:{label:"return time"}},[e._v(e._s(e.borrowingDetail.return_time))]),o("a-descriptions-item",{attrs:{label:"fine"}},[e._v(" "+e._s(e.borrowingDetail.fine)+" ")])],1)],0===e.borrowingDetail.status?o("a-tooltip",{staticClass:"item",attrs:{effect:"dark",size:"small",content:"详情",placement:"top"}},[e.borrowingDetail.fine>0?o("a-popconfirm",{attrs:{title:"Are you sure to pay the fine?"},on:{confirm:function(t){return e.payFine()},cancel:e.cancel}},[o("a-button",{style:{top:"8px",marginLeft:"8px"},attrs:{type:"primary",icon:"el-icon-edit"}},[e._v("Pay")])],1):e._e(),o("a-popconfirm",{attrs:{title:"Are you sure to renew the book"},on:{confirm:function(t){return e.renewBook()},cancel:e.cancel}},[o("a-button",{style:{top:"8px",marginLeft:"8px"},attrs:{type:"primary",icon:"el-icon-edit"}},[e._v("Renew")])],1)],1):e._e()],2)},r=[],i=o("1da1"),a=(o("96cf"),o("d3b7"),o("e9c4"),o("99af"),o("93d6")),c=o("c1df"),s=o.n(c),u={data:function(){return{borrowingDetail:[],book_cover:"null",book_name:"null",bookInfo:[],orderUrl:"https://1893791694056142.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/web-framework/express-app/createOrder"}},created:function(){this.getBorrowingDetail(this.$route.params.id)},methods:{getBorrowingDetail:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function o(){var n,r,i,c,u,l,d,p,b;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t,r=new Headers,r.append("token",Object(a["c"])()),r.append("Content-Type","application/json"),i={method:"GET",headers:r},c=t.$global.BASE_URL+"/api/user/borrowing/detail?borrowing_id="+e,u=new Request(c,i),o.next=9,fetch(u).then((function(e){return e.json()})).then((function(e){console.log("borrowing_detail",e),n.borrowingDetail=e.data,n.borrowingDetail.borrow_time=s()(n.borrowingDetail.borrow_time).format("dddd, MMMM Do YYYY"),n.borrowingDetail.due_time=s()(n.borrowingDetail.dues_time).format("dddd, MMMM Do YYYY")})).catch((function(e){return console.log("Request Failed",e)}));case 9:return console.log(t.borrowingDetail),l=new Headers,l.append("Content-Type","application/json"),l.append("token",Object(a["c"])()),d={method:"GET",headers:l},p=t.$global.BASE_URL+"/api/admin/book/detail?ISBN="+t.borrowingDetail.ISBN,b=new Request(p,d),o.next=18,fetch(b).then((function(e){return e.json()})).then((function(e){console.log("book_detail",e),n.book_name=e.data[0].bookName,n.book_cover=e.data[0].cover,n.bookInfo=e.data[0],console.log(n.bookInfo)}));case 18:case"end":return o.stop()}}),o)})))()},returnBook:function(e){var t=this;console.log(e);var o=new Headers;o.append("token",Object(a["c"])()),o.append("Content-Type","application/json");var n={method:"POST",headers:o,body:JSON.stringify({borrowing_id:e})},r=this.$global.BASE_URL+"/api/borrowing/return",i=new Request(r,n);fetch(i).then((function(e){return e.json()})).then((function(e){console.log("return",e),0===e.code?t.$message.success("return successfully!"):t.$message.error(e.msg)})).catch((function(e){return console.log("Request Failed",e)}))},cancel:function(){},renewBook:function(e){var t=this;console.log(e);var o=new Headers;o.append("Content-Type","application/json"),o.append("token",Object(a["c"])());var n={borrowing_id:e},r={method:"POST",body:JSON.stringify(n),headers:o},i=new Request(this.$global.BASE_URL+"/api/borrowing/renew",r);fetch(i).then((function(e){return e.json()})).then((function(e){console.log(e),0===e.code?t.$message.success("renew successfully!"):t.$message.error(e.msg)})).catch((function(e){return console.log("Request Failed",e)}))},payFine:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var o,n,r,i,c,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o="fine".concat(e.borrowingDetail.borrowing_id),n=e.borrowingDetail.ISBN,r=e.borrowingDetail.book_id,i=Object(a["d"])().user_id,c=1,s=e.borrowingDetail.fine,u=s,e,t.next=10,fetch(e.orderUrl,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"payName=".concat(i,"&goodsName=").concat(o,"&price=").concat(s,"&count=").concat(c,"&cost=").concat(u,"&ISBN=").concat(n,"&book_id=").concat(r)}).then((function(e){return e.text()})).then((function(e){document.querySelector("body").innerHTML=e;var t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t),console.log(11111,document.forms[0]),document.forms[0].submit()}));case 10:case"end":return t.stop()}}),t)})))()}}},l=u,d=o("2877"),p=Object(d["a"])(l,n,r,!1,null,null,null);t["default"]=p.exports},e8b5:function(e,t,o){var n=o("c6b6");e.exports=Array.isArray||function(e){return"Array"==n(e)}}}]);
//# sourceMappingURL=chunk-309ed962.591036eb.js.map