(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d970c74"],{"47fd":function(o,t,e){},"5fb1":function(o,t,e){"use strict";e.r(t);var a=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div",[e("a-layout",{staticStyle:{background:"#fff",height:"100%"}},[e("a-layout-sider",{staticStyle:{background:"#fff"},attrs:{width:"250"}},[e("a-menu",{staticStyle:{height:"100%"},attrs:{mode:"inline","default-selected-keys":["2"]}},[e("a-menu-item",{key:"1",on:{click:function(t){return o.changeContent()}}},[o._v("图书查询")]),e("a-menu-item",{key:"2"},[o._v("图书详情")])],1)],1),e("a-layout-content",{style:{padding:"0 24px",minHeight:"50vh"}},[e("a-card",{attrs:{bordered:!1}},[e("a-col",{attrs:{span:16}},[e("a-row",[e("a-col",{attrs:{span:8}},[e("a-card",{staticStyle:{width:"500px",height:"250px"},attrs:{title:o.bookInfo.book_name,bordered:!1}},[e("p",[o._v("ISBN："+o._s(o.bookInfo.ISBN))]),e("p",[o._v("作者："+o._s(o.bookInfo.author))]),e("p",[o._v("类别："+o._s(o.bookInfo.category))]),e("p",[o._v("出版社："+o._s(o.bookInfo.publisher))]),e("p",[o._v("出版时间："+o._s(o.bookInfo.published_time))])])],1),e("a-col",{attrs:{offset:16}},[e("a-card",{staticStyle:{height:"200px",width:"200px"},attrs:{bordered:!1,size:"small"}},[e("br"),e("br"),e("p",[o._v(" 余量："+o._s(o.avail_book_number)+"  "),o.avail_book_number/o.book_number>=.5?e("a-tag",{attrs:{color:"green"}},[o._v("余量充足")]):o._e(),o.avail_book_number/o.book_number<.5?e("a-tag",{attrs:{color:"red"}},[o._v("余量紧张")]):o._e()],1),e("a-progress",{staticStyle:{color:"green"},attrs:{type:"circle",width:150,percent:parseInt(o.avail_book_number/o.book_number*100),size:"small",status:"active"}}),e("br"),e("br"),e("br"),e("br")],1)],1)],1),e("a-row",[e("a-col",{attrs:{span:8}},[e("a-card",{staticStyle:{width:"750px",height:"200px"},attrs:{bordered:!1}},[e("p",[o._v("摘要："+o._s(o.bookInfo.introduction))])])],1)],1)],1),e("a-col",{attrs:{span:8}},[e("img",{attrs:{src:"https://img4.doubanio.com/view/subject/s/public/s34080469.jpg",alt:"img",height:"400"}})])],1),e("a-card",[e("a-table",{attrs:{columns:o.columns,"data-source":o.locationData},scopedSlots:o._u([{key:"status",fn:function(t){return[1==t?e("a-tag",{attrs:{color:"green"}},[o._v("可借阅")]):0==t?e("a-tag",{attrs:{color:"red"}},[o._v("已借出")]):o._e()]}},{key:"operation",fn:function(t,a){return[e("a-popconfirm",{attrs:{title:"Sure to Borrow?"},on:{confirm:function(){return o.onBorrow(a.key)}}},[e("a",{attrs:{href:"javascript:;"}},[o._v("Borrow")])])]}}])})],1)],1)],1)],1)},n=[],r=e("b85c"),s=(e("d3b7"),[{title:"房间号",dataIndex:"room_number",key:"room_number"},{title:"bookshelf书架",dataIndex:"book_shelf",key:"book_shelf"},{title:"side边",dataIndex:"side",key:"side"},{title:"layer层",dataIndex:"layer",key:"layer"},{title:"status状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"操作",key:"operation",scopedSlots:{customRender:"operation"}}]),i={name:"Detail",data:function(){return{book_number:"",avail_book_number:"",locationData:[],columns:s,bookInfo:{ISBN:"",cover:"",book_name:"",introduction:"",publisher:"",published_time:"",author:"",category:""}}},methods:{changeContent:function(){this.$router.push("/book/search").catch((function(o){console.log("输出报错",o)}))},getBookISBN:function(){return this.$route.params.id},onBorrow:function(o){},getBookInfo:function(){var o=this,t="https://www.fastmock.site/mock/891abb0e6bd9ffe5f4e30bde7ed7516e/spm";this.loading=!0;var e=new Headers,a={method:"POST",headers:e,body:this.getBookISBN()};fetch("".concat(t,"/api/book/detail"),a).then((function(o){return o.json()})).then((function(t){console.log(t),0==t.error_code&&(o.bookInfo.ISBN=t.book_info.ISBN,o.bookInfo.cover=t.book_info.cover,o.bookInfo.book_name=t.book_info.book_name,o.bookInfo.introduction=t.book_info.introduction,o.bookInfo.publisher=t.book_info.publisher,o.bookInfo.published_time=t.book_info.published_time,o.bookInfo.author=t.book_info.author,o.bookInfo.category=t.book_info.category)})).catch((function(o){return console.log("error",o)}))},getBookLocations:function(){var o=this,t="https://www.fastmock.site/mock/891abb0e6bd9ffe5f4e30bde7ed7516e/spm";this.loading=!0;var e=new Headers,a={method:"POST",headers:e,body:this.getBookISBN()},n=this;fetch("".concat(t,"/api/book/locations"),a).then((function(o){return o.json()})).then((function(t){if(console.log(t),0==t.error_code){o.book_number=t.locations.length;var e,a=0,s=Object(r["a"])(t.locations);try{for(s.s();!(e=s.n()).done;){var i=e.value;1==i.status&&a++}}catch(c){s.e(c)}finally{s.f()}o.avail_book_number=a,setTimeout((function(){var o,e=0,a=Object(r["a"])(t.locations);try{for(a.s();!(o=a.n()).done;){var s=o.value;n.locationData.push({key:e,status:s.status,room_number:s.room_number,book_shelf:s.book_shelf,side:s.side,layer:s.layer}),e++}}catch(c){a.e(c)}finally{a.f()}n.loading=!1}),200)}})).catch((function(o){return console.log("error",o)}))}},created:function(){this.id=this.getBookISBN(),this.getBookInfo(),this.getBookLocations()}},c=i,l=(e("8ee4"),e("2877")),u=Object(l["a"])(c,a,n,!1,null,null,null);t["default"]=u.exports},"8ee4":function(o,t,e){"use strict";e("47fd")}}]);
//# sourceMappingURL=chunk-7d970c74.b884b741.js.map