(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21ab1a"],{bd35:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"body"}},[[o("a-card",{staticStyle:{width:"240px"},attrs:{hoverable:""},scopedSlots:e._u([{key:"cover",fn:function(){return[o("img",{attrs:{src:e.bookInfo.cover}})]},proxy:!0}])})],[o("a-descriptions",{attrs:{title:"Borrowing Info",size:"default",bordered:""}},[o("a-descriptions-item",{attrs:{label:"book name "}},[e._v(e._s(this.bookInfo.bookName))]),o("a-descriptions-item",{attrs:{label:"borrowing id"}},[e._v(e._s(e.borrowingDetail.borrowing_id))]),o("a-descriptions-item",{attrs:{label:"ISBN"}},[e._v(e._s(e.borrowingDetail.ISBN))]),o("a-descriptions-item",{attrs:{label:"status"}},[e._v(e._s(e.borrowingDetail.status))]),o("a-descriptions-item",{attrs:{label:"borrow time"}},[e._v(e._s(e.borrowingDetail.borrow_time))]),o("a-descriptions-item",{attrs:{label:"due time"}},[e._v(e._s(e.borrowingDetail.due_time))]),o("a-descriptions-item",{attrs:{label:"return time"}},[e._v(e._s(e.borrowingDetail.return_time))]),o("a-descriptions-item",{attrs:{label:"fine"}},[e._v(" "+e._s(e.borrowingDetail.fine)+" ")])],1)],0===e.borrowingDetail.status?o("a-tooltip",{staticClass:"item",attrs:{effect:"dark",size:"small",content:"详情",placement:"top"}},[o("a-popconfirm",{attrs:{title:"Are you sure to pay the fine?"},on:{confirm:function(t){return e.payFine()},cancel:e.cancel}},[o("a-button",{style:{top:"8px",marginLeft:"8px"},attrs:{type:"primary",icon:"el-icon-edit"}},[e._v("pay")])],1),o("a-popconfirm",{attrs:{title:"Are you sure to renew the book"},on:{confirm:function(t){return e.renewBook()},cancel:e.cancel}},[o("a-button",{style:{top:"8px",marginLeft:"8px"},attrs:{type:"primary",icon:"el-icon-edit"}},[e._v("renew")])],1)],1):e._e()],2)},r=[],i=o("1da1"),a=(o("96cf"),o("d3b7"),o("e9c4"),o("93d6")),s=o("c1df"),c=o.n(s),l={data:function(){return{borrowingDetail:[],book_cover:"null",book_name:"null",bookInfo:[],orderUrl:"https://1893791694056142.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/web-framework/express-app/createOrder"}},created:function(){this.getBorrowingDetail(this.$route.params.id)},methods:{getBorrowingDetail:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function o(){var n,r,i,s,l,u,d,p,b;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=t,r=new Headers,r.append("token",Object(a["b"])()),r.append("Content-Type","application/json"),i={method:"GET",headers:r},s=t.$global.BASE_URL+"/api/user/borrowing/detail?borrowing_id="+e,l=new Request(s,i),o.next=9,fetch(l).then((function(e){return e.json()})).then((function(e){console.log("borrowing_detail",e),n.borrowingDetail=e.data,n.borrowingDetail.borrow_time=c()(n.borrowingDetail.borrow_time).format("dddd, MMMM Do YYYY"),n.borrowingDetail.due_time=c()(n.borrowingDetail.dues_time).format("dddd, MMMM Do YYYY")})).catch((function(e){return console.log("Request Failed",e)}));case 9:return console.log(t.borrowingDetail),u=new Headers,u.append("Content-Type","application/json"),u.append("token",Object(a["b"])()),d={method:"GET",headers:u},p=t.$global.BASE_URL+"/api/admin/book/detail?ISBN="+t.borrowingDetail.ISBN,b=new Request(p,d),o.next=18,fetch(b).then((function(e){return e.json()})).then((function(e){console.log("book_detail",e),n.book_name=e.data[0].bookName,n.book_cover=e.data[0].cover,n.bookInfo=e.data[0],console.log(n.bookInfo)}));case 18:case"end":return o.stop()}}),o)})))()},returnBook:function(e){var t=this;console.log(e);var o=new Headers;o.append("token",Object(a["b"])()),o.append("Content-Type","application/json");var n={method:"POST",headers:o,body:JSON.stringify({borrowing_id:e})},r=this.$global.BASE_URL+"/api/borrowing/return",i=new Request(r,n);fetch(i).then((function(e){return e.json()})).then((function(e){console.log("return",e),0===e.code?t.$message.success("return successfully!"):t.$message.error(e.msg)})).catch((function(e){return console.log("Request Failed",e)}))},cancel:function(){},renewBook:function(e){var t=this;console.log(e);var o=new Headers;o.append("Content-Type","application/json"),o.append("token",Object(a["b"])());var n={borrowing_id:e},r={method:"POST",body:JSON.stringify(n),headers:o},i=new Request(this.$global.BASE_URL+"/api/borrowing/renew",r);fetch(i).then((function(e){return e.json()})).then((function(e){console.log(e),0===e.code?t.$message.success("renew successfully!"):t.$message.error(e.msg)})).catch((function(e){return console.log("Request Failed",e)}))},payFine:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"fine".concat(e.borrowing_id),Object(a["c"])().user_id,1,o=e.borrowingDetail.fine,o,n=e,t.next=8,fetch(e.orderUrl,{method:"POST",body:"payName=test&goodsName=%E5%A4%A7%E5%8D%AB%E9%BE%99&price=2&count=1&cost=2.00"}).then((function(e){return e.text()})).then((function(e){n.$root.$el.innerHTML=e,console.log(n.$root.$el.innerHTML)}));case 8:case"end":return t.stop()}}),t)})))()}}},u=l,d=o("2877"),p=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d21ab1a.d7eacefe.js.map