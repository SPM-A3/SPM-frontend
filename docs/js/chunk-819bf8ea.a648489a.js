(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-819bf8ea"],{"0131":function(e,t,a){e.exports=a.p+"img/wallet.29f978a9.png"},"0bdb":function(e,t,a){},"103d":function(e,t,a){"use strict";a("0bdb")},"1ad2":function(e,t,a){},3521:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"standard-table"},[a("div",{staticClass:"alert"},[e.selectedRows?a("a-alert",{attrs:{type:"info","show-icon":!0}},[a("div",{staticClass:"message",attrs:{slot:"message"},slot:"message"},[e._v(" select "),a("a",[e._v(e._s(e.selectedRows.length))]),e._v(" items "),a("a",{staticClass:"clear",on:{click:e.onClear}},[e._v("clear")])])]):e._e()],1),a("a-table",{attrs:{bordered:e.bordered,loading:e.loading,columns:e.columns,dataSource:e.dataSource,rowKey:e.rowKey,pagination:e.pagination,expandedRowKeys:e.expandedRowKeys,expandedRowRender:e.expandedRowRender,rowSelection:e.selectedRows?{selectedRowKeys:e.selectedRowKeys,onChange:e.updateSelect,getCheckboxProps:e.getCheckboxProps}:void 0},on:{change:e.onChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(a,o,n){return[e._t(t,null,null,{text:a,record:o,index:n})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,a,o,n){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:a,indent:o,expanded:n})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return a("template",{slot:t},[e._t(t)],2)}))],2)],1)},n=[],r=a("c1f7"),s=r["a"],c=(a("f0e9"),a("2877")),l=Object(c["a"])(s,o,n,!1,null,"b619feae",null);t["a"]=l.exports},"392b":function(e,t,a){"use strict";a("cd64")},"3fb1":function(e,t,a){e.exports=a.p+"img/book.5c70d2f1.png"},"4b39":function(e,t,a){e.exports=a.p+"img/damaged_book.cc727d47.png"},"50f5":function(e,t,a){},"619e":function(e,t,a){},"8c0d":function(e,t,a){e.exports=a.p+"img/borrowing_book.ffcfea48.png"},"8eb7":function(e,t,a){"use strict";a("a0b5")},a0b5:function(e,t,a){},c08b:function(e,t,a){e.exports=a.p+"img/reader.331a2f6e.png"},c1f7:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_chentong_Documents_code_SPM_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5530"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("4de4"),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__);__webpack_exports__["a"]={name:"StandardTable",props:{bordered:Boolean,loading:[Boolean,Object],columns:Array,dataSource:Array,rowKey:{type:[String,Function],default:"key"},pagination:{type:[Object,Boolean],default:!0},selectedRows:Array,expandedRowKeys:Array,expandedRowRender:Function},data:function(){return{needTotalList:[]}},methods:{updateSelect:function(e,t){this.$emit("update:selectedRows",t),this.$emit("selectedRowChange",e,t)},initTotalList:function(e){var t=e.filter((function(e){return e.needTotal})).map((function(e){return Object(_Users_chentong_Documents_code_SPM_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__["a"])(Object(_Users_chentong_Documents_code_SPM_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__["a"])({},e),{},{total:0})}));return t},onClear:function(){this.updateSelect([],[]),this.$emit("clear")},onChange:function(e,t,a,o){var n=o.currentDataSource;this.$emit("change",e,t,a,{currentDataSource:n})},getCheckboxProps:function(e){return{props:{disabled:e.fine>0}}}},created:function(){this.needTotalList=this.initTotalList(this.columns)},watch:{selectedRows:function selectedRows(_selectedRows){this.needTotalList=this.needTotalList.map((function(item){return Object(_Users_chentong_Documents_code_SPM_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__["a"])(Object(_Users_chentong_Documents_code_SPM_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_0__["a"])({},item),{},{total:_selectedRows.reduce((function(sum,val){var v;try{v=val[item.dataIndex]?val[item.dataIndex]:eval("val.".concat(item.dataIndex))}catch(_){v=val[item.dataIndex]}return v=isNaN(parseFloat(v))?0:parseFloat(v),sum+v}),0)})}))}},computed:{selectedRowKeys:function(){var e=this;return this.selectedRows.map((function(t){return"function"===typeof e.rowKey?e.rowKey(t):t[e.rowKey]}))}}}},c30e:function(e,t,a){"use strict";a("e12b")},c740:function(e,t,a){"use strict";var o=a("23e7"),n=a("b727").findIndex,r=a("44d2"),s="findIndex",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),o({target:"Array",proto:!0,forced:c},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(s)},cd64:function(e,t,a){},d81d:function(e,t,a){"use strict";var o=a("23e7"),n=a("b727").map,r=a("1dde"),s=r("map");o({target:"Array",proto:!0,forced:!s},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},d824:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-layout",{staticStyle:{background:"#fff",height:"100%"}},[a("a-layout-sider",{staticStyle:{background:"#fff"},attrs:{width:"200",breakpoint:"lg","collapsed-width":"0",theme:"light"},on:{collapse:e.onCollapse,breakpoint:e.onBreakpoint}},[a("a-menu",{staticStyle:{height:"100%"},attrs:{mode:"inline","default-selected-keys":e.defaultSelectedKeys}},[a("a-menu-item",{key:"0",on:{click:function(t){return e.changeContent(0)}}},[e._v("Dashboard")]),a("a-menu-item",{key:"1",on:{click:function(t){return e.changeContent(1)}}},[e._v("Book management")]),a("a-menu-item",{key:"2",on:{click:function(t){return e.changeContent(2)}}},[e._v("User management")]),a("a-menu-item",{key:"3",on:{click:function(t){return e.changeContent(3)}}},[e._v("Borrow management")]),a("a-menu-item",{key:"4",on:{click:function(t){return e.changeContent(4)}}},[e._v("Fine management")]),a("a-menu-item",{key:"5",on:{click:function(t){return e.changeContent(5)}}},[e._v("Reservation management")])],1)],1),a("a-layout-content",{style:{padding:"0 24px",minHeight:"50vh"}},[0==e.contentNumber?a("div",[a("dashboard",{on:{changeContent:e.changeContent}})],1):1==e.contentNumber?a("div",[a("book-manage")],1):2==e.contentNumber?a("div",[a("user-manage")],1):3==e.contentNumber?a("div",[a("borrow-manage")],1):4==e.contentNumber?a("div",[a("fine-manage")],1):5==e.contentNumber?a("div",[a("reservation-manage")],1):e._e()])],1)},n=[],r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("a-card",{attrs:{bordered:!1}},[o("a-row",[o("a-col",{attrs:{span:2}},[o("a-avatar",{attrs:{size:70,src:e.userInfo.avatar}})],1),o("a-col",{attrs:{offset:2}},[o("p",{staticStyle:{"font-size":"15px"}},[e._v(" Hello, administrator "),o("b",[e._v(e._s(e.userInfo.name))]),e._v(" . Today is "+e._s(e.time.weekday)+" "+e._s(e.time.month)+" "+e._s(e.time.day)+" "+e._s(e.time.year)+". ")]),e._v(" ID: "+e._s(e.userInfo.id)+" ")])],1)],1),o("a-row",{staticStyle:{"margin-top":"0"},attrs:{gutter:[24,24]}},[o("a-col",{attrs:{sm:24,md:12,xl:8}},[o("a-card",{attrs:{id:"reader_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("READERS")]),o("a-icon",{attrs:{slot:"suffix",type:"book"},slot:"suffix"}),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_readers))]),o("a",{on:{click:function(t){return e.changeContent(2)}}},[e._v("MORE INFO >")])],1),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("c08b"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:8}},[o("a-card",{attrs:{id:"fine_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("FINE")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_fine))]),o("a",{on:{click:function(t){return e.changeContent(4)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("f325"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:8}},[o("a-card",{attrs:{id:"fine_collected_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("FINE COLLECTED")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_fine_collected))]),o("a",{on:{click:function(t){return e.changeContent(4)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("0131"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:6}},[o("a-card",{attrs:{id:"book_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("BOOKS")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_books))]),o("a",{on:{click:function(t){return e.changeContent(1)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("3fb1"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:6}},[o("a-card",{attrs:{id:"borrowing_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("BORROWING")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_borrowings))]),o("a",{on:{click:function(t){return e.changeContent(3)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("8c0d"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:6}},[o("a-card",{attrs:{id:"damaged_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("DAMAGED")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_damaged_books))]),o("a",{on:{click:function(t){return e.changeContent(1)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:15}},[o("img",{attrs:{src:a("4b39"),width:"100"}})])],1)],1)],1),o("a-col",{attrs:{sm:24,md:12,xl:6}},[o("a-card",{attrs:{id:"lost_book_card"}},[o("a-row",[o("a-col",{attrs:{span:12}},[o("h1",[e._v("LOST")]),o("h1",{staticStyle:{"font-size":"40px"}},[e._v(e._s(e.total_lost_books))]),o("a",{on:{click:function(t){return e.changeContent(1)}}},[e._v("MORE INFO >")])]),o("a-col",{attrs:{offset:13}},[o("img",{attrs:{src:a("d8da"),width:"150"}})])],1)],1)],1)],1)],1)},s=[],c=(a("d3b7"),a("b0c0"),a("93d6")),l={name:"dashboard",data:function(){return{total_readers:"",total_books:"",total_book_copys:"",total_borrowings:"",total_fine:"",total_lost_books:"",total_damaged_books:"",total_fine_collected:"",userInfo:{},time:{weekday:"",day:"",month:"",year:""}}},methods:{changeContent:function(e){this.$emit("changeContent",e)},getUserInfo:function(){this.loading=!0,this.userInfo.avatar=Object(c["d"])().avatar;var e=new Headers({"Content-Type":"application/json"});e.append("token",Object(c["c"])()),console.log;var t={method:"GET",headers:e},a=this;fetch("".concat(this.$global.BASE_URL,"/api/user/profile/detail"),t).then((function(e){return e.json()})).then((function(e){console.log(e),a.userInfo.id=e.data.id,a.userInfo.name=e.data.name,a.userInfo.gender=e.data.gender,a.userInfo.position=e.data.position,a.userInfo.phone_number=e.data.phone_number,a.userInfo.email=e.data.email,a.userInfo.user_id=e.data.user_id,a.userInfo.borrowing=e.data.borrowings,a.userInfo.maxBorrowing=e.data.max_borrowing})).catch((function(e){return console.log("error",e)}))},getDashboardInfo:function(){var e=this,t=new Headers;t.append("token",Object(c["c"])());var a={method:"GET",headers:t};fetch("".concat(this.$global.BASE_URL,"/api/admin/dashboard"),a).then((function(e){return e.json()})).then((function(t){console.log(t),0==t.code&&(e.total_readers=t.data.total_readers,e.total_books=t.data.total_books,e.total_book_copys=t.data.total_book_copys,e.total_borrowings=t.data.total_borrowings,e.total_fine=t.data.total_fine,e.total_lost_books=t.data.total_lost_books,e.total_damaged_books=t.data.total_damaged_books,e.total_fine_collected=t.data.total_fine_collected)})).catch((function(e){return console.log("error",e)}))},getTime:function(){var e=new Date,t=e.getDay();switch(t){case 1:this.time.weekday="Mon";break;case 2:this.time.weekday="Tue";break;case 3:this.time.weekday="Wes";break;case 4:this.time.weekday="Thu";break;case 5:this.time.weekday="Fri";break;case 6:this.time.weekday="Sat";break;case 0:this.time.weekday="Sun";break}this.time.day=e.getDate();var a=e.getMonth();switch(a){case 0:this.time.month="Jan";break;case 1:this.time.month="Feb";break;case 2:this.time.month="Mar";break;case 3:this.time.month="Apr";break;case 4:this.time.month="May";break;case 5:this.time.month="Jun";break;case 6:this.time.month="Jul";break;case 7:this.time.month="Aug";break;case 8:this.time.month="Sept";break;case 9:this.time.month="Oct";break;case 10:this.time.month="Nov";break;case 11:this.time.month="Dec";break}this.time.year=e.getFullYear(),console.log(this.time)}},created:function(){this.getDashboardInfo(),this.getUserInfo(),this.getTime()}},i=l,d=(a("103d"),a("2877")),u=Object(d["a"])(i,r,s,!1,null,"337945d8",null),h=u.exports,f=function(){var e=this,t=this,a=t.$createElement,o=t._self._c||a;return o("a-card",{attrs:{bordered:!1}},[o("div",{class:t.advanced?"search":null},[o("a-form",{attrs:{layout:"horizontal"}},[o("div",{class:t.advanced?null:"fold"},[o("a-row",[o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"Book name",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-input",{attrs:{placeholder:"Please input book name"},model:{value:t.searchQuery.book_name,callback:function(e){t.$set(t.searchQuery,"book_name",e)},expression:"searchQuery.book_name"}})],1)],1),o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"Author",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-input",{attrs:{placeholder:"Please input author"},model:{value:t.searchQuery.author,callback:function(e){t.$set(t.searchQuery,"author",e)},expression:"searchQuery.author"}})],1)],1),o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"Publisher",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Please input publisher"},model:{value:t.searchQuery.publisher,callback:function(e){t.$set(t.searchQuery,"publisher",e)},expression:"searchQuery.publisher"}})],1)],1)],1),t.advanced?o("a-row",[o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"Publish date",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select publish date"},on:{change:t.onChange},model:{value:t.searchQuery.date,callback:function(e){t.$set(t.searchQuery,"date",e)},expression:"searchQuery.date"}})],1)],1),o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"Book category",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-cascader",{attrs:{options:t.options,placeholder:"Please search for or select a book category","show-search":{filter:t.filter}}})],1)],1),o("a-col",{attrs:{md:8,sm:24}},[o("a-form-item",{attrs:{label:"ISBN",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[o("a-input",{attrs:{placeholder:"Please input ISBN"}})],1)],1)],1):t._e()],1),o("span",{staticStyle:{float:"right","margin-top":"3px"}},[o("a-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("Search")]),o("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.resetQuery}},[t._v("Reset")]),o("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"fold":"unfold")+" "),o("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],1),o("div",[o("a-space",{staticClass:"operator"},[o("a-dropdown-button",{attrs:{loading:t.loading2,type:"primary"},on:{click:t.addNewBook}},[t._v(" Add "),o("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[o("a-menu-item",{key:"1",on:{click:function(){e.$router.push("/admin/book/add")}}},[t._v("Add book manually")]),o("a-menu-item",{key:"2",on:{click:function(){e.$router.push("/admin/book/category/add")}}},[t._v(" Add category ")])],1),o("a-icon",{attrs:{slot:"icon",type:"down"},slot:"icon"})],1),o("a-popconfirm",{attrs:{title:"Are you sure delete the selected books?","ok-text":"Yes","cancel-text":"No"},on:{confirm:t.remove}},[o("a-button",{attrs:{type:"danger"}},[t._v(" delete ")])],1)],1),o("standard-table",{attrs:{loading:t.loading,columns:t.columns,dataSource:t.dataSource,selectedRows:t.selectedRows},on:{"update:selectedRows":function(e){t.selectedRows=e},"update:selected-rows":function(e){t.selectedRows=e},clear:t.onClear,change:t.onChange,selectedRowChange:t.onSelectChange},scopedSlots:t._u([{key:"barcode",fn:function(e){var t=e.record;return o("div",{staticStyle:{width:"250px"}},[o("vue-barcode",{staticStyle:{width:"100%"},attrs:{value:t.key}})],1)}},{key:"description",fn:function(e){var a=e.text;return o("div",{staticStyle:{width:"100px","font-size":"50%"}},[t._v(" "+t._s(a.slice(0,50))+"... ")])}},{key:"action",fn:function(e){var a=e.record;return o("div",{staticStyle:{width:"60px"}},[o("a-dropdown",{attrs:{trigger:["click"]}},[o("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[t._v(" actions "),o("a-icon",{attrs:{type:"down"}})],1),o("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[o("a-menu-item",{key:"0"},[o("router-link",{attrs:{to:"/admin/book/"+a.key+"/edit"}},[o("a-space",[o("a-icon",{attrs:{type:"edit"}}),o("span",[t._v("Edit")])],1)],1)],1),o("a-menu-item",{key:"1"},[o("router-link",{attrs:{to:"/admin/book/"+a.key}},[o("a-space",[o("a-icon",{attrs:{type:"file-text"}}),o("span",[t._v("Detail")])],1)],1)],1),o("a-menu-item",{key:"2"},[o("router-link",{attrs:{to:"/admin/book/"+a.key+"/addload"}},[o("a-space",[o("a-icon",{attrs:{type:"plus"}}),o("span",[t._v("Add collection")])],1)],1)],1)],1)],1),o("a-space",{attrs:{direction:"vertical"}})],1)}},{key:"cover",fn:function(e){var t=e.record;return o("div",{},[o("img",{staticStyle:{width:"150px"},attrs:{slot:"avatar",size:"large",shape:"square",src:t.cover},slot:"avatar"})])}}])},[o("template",{slot:"statusTitle"},[o("a-icon",{attrs:{type:"info-circle"},nativeOn:{click:function(e){return t.onStatusTitleClick.apply(null,arguments)}}})],1)],2)],1)])},p=[],b=a("1da1"),_=a("b85c"),m=(a("96cf"),a("4de4"),a("e9c4"),a("c740"),a("99af"),a("fb6a"),a("3521")),v=a("e81a"),g=a("3723"),y=a.n(g),k=[{title:"cover",dataIndex:"cover",needTotal:!0,scopedSlots:{customRender:"cover"}},{title:"title",dataIndex:"book_name"},{title:"introduction",dataIndex:"brief_introduction",scopedSlots:{customRender:"description"}},{title:"publisher",dataIndex:"publisher"},{title:"publish date",sorter:!0,dataIndex:"published_time"},{title:"author",dataIndex:"author"},{title:"category",dataIndex:"category"},{title:"ISBN",dataIndex:"key",sorter:!0,scopedSlots:{customRender:"barcode"}},{title:"actions",scopedSlots:{customRender:"action"}}],w={name:"BookManage",components:{StandardTable:m["a"],VueBarcode:y.a},data:function(){return{loading2:!1,advanced:!0,columns:k,dataSource:[],selectedRows:[],loading:!0,options:[],searchQuery:{book_name:"",author:"",publisher:"",ISBN:"",category:void 0,date:""}}},authorize:{deleteRecord:"delete"},methods:{deleteRecord:function(e){this.dataSource=this.dataSource.filter((function(t){return t.key!==e})),this.selectedRows=this.selectedRows.filter((function(t){return t.key!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced},remove:function(){if(0!=this.selectedRows.length){this.loading=!0;var e,t=[],a=Object(_["a"])(this.selectedRows);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(o.key)}}catch(i){a.e(i)}finally{a.f()}var n=new Headers;n.append("token",Object(c["c"])()),n.append("Content-Type","application/json");var r=JSON.stringify(t),s={method:"DELETE",headers:n,body:r},l=this;fetch("".concat(this.$global.BASE_URL,"/api/admin/book/delete"),s).then((function(e){return e.json()})).then((function(e){var t=e.code;e.msg,e.data;"0"===t||0===t?(l.$message.success("Delete books successfully."),l.dataSource=l.dataSource.filter((function(e){return-1===l.selectedRows.findIndex((function(t){return t.key===e.key}))}))):500==e.status&&l.$message.error("Fail to delete books. Please contact the manager."),l.selectedRows=[],l.loading=!1})).catch((function(e){l.selectedRows=[],l.$message.error("API call failed"),l.loading=!1}))}else this.$message.error("No selected books.")},onClear:function(){},onStatusTitleClick:function(){},onChange:function(){},onSelectChange:function(){},addNewBook:function(){this.loading2=!0;var e=this;this.$router.push("/admin/book/addByApi").then((function(){e.loading2=!1}))},handleMenuClick:function(e){"delete"===e.key&&this.remove()},filter:function(e,t){return t.some((function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1}))},onChangeGategory:function(e,t){console.log(e,t)},getFormatCatgory:function(){return void 0===this.searchQuery.category||this.searchQuery.category===[]?"":this.searchQuery.category[0]},search:function(){var e=new Headers;e.append("token",Object(c["c"])());var t={method:"GET",headers:e};this.loading=!0;var a=this;fetch("".concat(this.$global.BASE_URL,"/api/book/search?book_name=").concat(this.searchQuery.book_name,"&author=").concat(this.searchQuery.author,"&publisher=").concat(this.searchQuery.publisher,"&ISBN=").concat(this.searchQuery.ISBN,"&category=").concat(this.getFormatCatgory(),"&pub_year=").concat(this.searchQuery.date?this.searchQuery.date.year():"","&pub_month=").concat(this.searchQuery.date?this.searchQuery.date.month():""),t).then((function(e){return e.json()})).then((function(e){0==e.code||"0"==e.code?setTimeout((function(){a.dataSource=[];var t,o=Object(_["a"])(e.data);try{for(o.s();!(t=o.n()).done;){var n=t.value;a.dataSource.push({key:n.ISBN,cover:n.cover,book_name:n.book_name,brief_introduction:n.brief_introduction+"",publisher:n.publisher,published_time:n.published_time,author:n.author,category:n.status})}}catch(r){o.e(r)}finally{o.f()}a.loading=!1}),200):(a.$messgae.error(e.msg),a.loading=!1)})).catch((function(e){a.$messgae.error("API call failed."),a.loading=!1}))},resetQuery:function(){this.searchQuery={book_name:"",author:"",publisher:"",ISBN:"",category:void 0,date:""}}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,v["a"].getOptions();case 3:e.options=t.sent,a=new Headers,a.append("token",Object(c["c"])()),o={method:"GET",headers:a},n=e,fetch("".concat(e.$global.BASE_URL,"/api/admin/book/getAll?page_size=100&current_page=1"),o).then((function(e){return e.json()})).then((function(e){0==e.code||"0"==e.code?setTimeout((function(){var t,a=Object(_["a"])(e.data.slice(1));try{for(a.s();!(t=a.n()).done;){var o=t.value;n.dataSource.push({key:o.ISBN,cover:o.cover,book_name:o.book_name,brief_introduction:o.brief_introduction+"",publisher:o.publisher,published_time:o.published_time,author:o.author,category:o.status})}}catch(r){a.e(r)}finally{a.f()}n.loading=!1}),200):n.loading=!1})).catch((function(e){console.log("error",e),n.loading=!1,n.$message.error("API call failed.")}));case 9:case"end":return t.stop()}}),t)})))()}},S=w,R=(a("c30e"),Object(d["a"])(S,f,p,!1,null,"69a945a2",null)),x=R.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced},[a("a-form-item",{attrs:{label:"ID",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-input",{attrs:{placeholder:"Please input id"},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1)],1),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.searchById}},[e._v("search")])],1)])],1),a("div",[a("a-space",{staticClass:"operator"},[a("a-button",{attrs:{type:"primary"},on:{click:e.addNewUser}},[e._v("new")]),a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.handleMenuClick},slot:"overlay"},[a("a-menu-item",{key:"delete"},[e._v("delete")]),a("a-menu-item",{key:"audit"},[e._v("disable")])],1),a("a-button",[e._v(" actions "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),a("standard-table",{attrs:{loading:e.loading,columns:e.columns,dataSource:e.dataSource,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t},clear:e.onClear,change:e.onChange,selectedRowChange:e.onSelectChange},scopedSlots:e._u([{key:"description",fn:function(t){var o=t.text;return a("div",{},[e._v(" "+e._s(o.slice(0,100))+"... ")])}},{key:"avatar",fn:function(e){var t=e.record;return a("div",{staticStyle:{width:"50px"}},[a("a-avatar",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.avatar}})],1)}},{key:"qrcode",fn:function(e){var t=e.record;return a("div",{staticStyle:{width:"100px"}},[a("vue-qr",{staticStyle:{width:"100px",height:"100px"},attrs:{text:t.id,qid:"testid"}})],1)}},{key:"action",fn:function(t){var o=t.record;return a("div",{staticStyle:{width:"60px"}},[a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v(" actions "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"0"},[a("router-link",{attrs:{to:"/admin/user/"+o.key+"/edit"}},[a("a-space",[a("a-icon",{attrs:{type:"edit"}}),a("span",[e._v("Edit")])],1)],1)],1),a("a-menu-item",{key:"1"},[a("router-link",{attrs:{to:"/admin/user/"+o.key+"/reservations"}},[a("a-space",[a("a-icon",{attrs:{type:"search"}}),a("span",[e._v("Reservations")])],1)],1)],1),a("a-menu-item",{key:"2"},[a("router-link",{attrs:{to:"/admin/user/"+o.key+"/borrowings"}},[a("a-space",[a("a-icon",{attrs:{type:"search"}}),a("span",[e._v("Borrowings")])],1)],1)],1)],1)],1),a("a-space",{attrs:{direction:"vertical"}})],1)}}])},[a("template",{slot:"statusTitle"},[a("a-icon",{attrs:{type:"info-circle"},nativeOn:{click:function(t){return e.onStatusTitleClick.apply(null,arguments)}}})],1)],2)],1)])},I=[],O=(a("25f0"),a("658f5")),E=a.n(O),T=[{title:"user_id",dataIndex:"key",needTotal:!0},{title:"avatar",dataIndex:"avatar",scopedSlots:{customRender:"avatar"}},{title:"id",dataIndex:"id"},{title:"name",dataIndex:"name"},{title:"gender",dataIndex:"gender"},{title:"position",dataIndex:"position"},{title:"email",dataIndex:"email"},{title:"phone",dataIndex:"phone_number"},{title:"borrow limit",dataIndex:"max_borrowing"},{title:"QRcode",scopedSlots:{customRender:"qrcode"}},{title:"actions",scopedSlots:{customRender:"action"}}],B=["MALE","FEMALE"],j=["Student","Teacher","Staff"],A={name:"UserManage",components:{StandardTable:m["a"],VueQr:E.a},data:function(){return{advanced:!0,columns:T,dataSource:[],selectedRows:[],loading:!0,id:""}},authorize:{deleteRecord:"delete"},methods:{deleteRecord:function(e){this.dataSource=this.dataSource.filter((function(t){return t.key!==e})),this.selectedRows=this.selectedRows.filter((function(t){return t.key!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced},remove:function(){this.loading=!0;var e,t=[],a=Object(_["a"])(this.selectedRows);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(o.key)}}catch(i){a.e(i)}finally{a.f()}var n=new Headers;n.append("token",Object(c["c"])()),n.append("Content-Type","application/json");var r=JSON.stringify(t),s={method:"DELETE",headers:n,body:r},l=this;fetch("".concat(this.$global.BASE_URL,"/api/admin/user/delete"),s).then((function(e){return e.json()})).then((function(e){var t=e.code;e.msg,e.data;"0"===t||0===t?(l.$message.success("Delete user successfully."),l.dataSource=l.dataSource.filter((function(e){return-1===l.selectedRows.findIndex((function(t){return t.key===e.key}))}))):500==e.status&&l.$message.error("Fail to delete users. Please contact the manager."),l.selectedRows=[],l.loading=!1})).catch((function(e){l.selectedRows=[],l.$message.error("API call failed"),l.loading=!1}))},onClear:function(){},onStatusTitleClick:function(){},onChange:function(){},onSelectChange:function(){},addNewUser:function(){this.$router.push("/admin/user/add").catch((function(e){console.log("跳转useradd报错",e)}))},handleMenuClick:function(e){"delete"===e.key&&this.remove()},searchById:function(){var e=this.id.toString();console.log(e),this.dataSource=this.dataSource.filter((function(t){return t.id===e}))}},created:function(){this.loading=!0;var e=new Headers;e.append("token",Object(c["c"])());var t={method:"GET",headers:e},a=this;fetch("".concat(this.$global.BASE_URL,"/api/admin/user/getAll?page_size=100&current_page=1"),t).then((function(e){return e.json()})).then((function(e){if(console.log(e),0==e.code||"0"==e.code){var t,o=Object(_["a"])(e.data.slice(1));try{for(o.s();!(t=o.n()).done;){var n=t.value;a.dataSource.push({key:n.userId,avatar:n.avatar,id:n.id,name:n.name,gender:B[n.gender],position:j[n.position],email:n.email,phone_number:n.phoneNumber,max_borrowing:20})}}catch(r){o.e(r)}finally{o.f()}a.loading=!1}else a.$message.error("API call failed."),a.loading=!1})).catch((function(e){a.loading=!1,a.$message.error("API call failed.")}))}},P=A,N=(a("392b"),Object(d["a"])(P,C,I,!1,null,"27c7e745",null)),D=N.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced},[a("a-form-item",{attrs:{label:"book barcode",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-input",{attrs:{placeholder:"Please scan book's barcode",disabled:e.loading2},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addBorrowing.apply(null,arguments)}},model:{value:e.barcode,callback:function(t){e.barcode=t},expression:"barcode"}})],1)],1)])],1),a("a-space",{staticClass:"operator"},[a("a-popconfirm",{attrs:{title:"Are you sure return the selected books?","ok-text":"Yes","cancel-text":"No",disabled:!e.dataSource.length},on:{confirm:e.returnBooks}},[a("a-button",{attrs:{type:"danger",disabled:!e.dataSource.length}},[e._v(" RETURN BOOKS ")])],1),a("a-button",{attrs:{type:"primary"},on:{click:e.showAll}},[e._v(" SHOW ALL ")])],1),a("standard-table",{attrs:{loading:e.loadingTable,columns:e.columns,dataSource:e.dataSource,selectedRows:e.selectedRows,getCheckboxProps:e.getCheckboxProps},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t},clear:e.onClear,change:e.onChange,selectedRowChange:e.onSelectChange},scopedSlots:e._u([{key:"barcode",fn:function(e){var t=e.record;return a("div",{staticStyle:{width:"250px"}},[a("vue-barcode",{staticStyle:{width:"100%"},attrs:{value:t.ISBN+"/"+t.book_id}})],1)}},{key:"cover",fn:function(e){var t=e.record;return a("div",{},[a("img",{staticStyle:{width:"150px"},attrs:{slot:"avatar",size:"large",shape:"square",src:t.cover},slot:"avatar"})])}},{key:"fine",fn:function(t){var o=t.record;return a("div",{},[0==o.fine?a("a-tag",{attrs:{color:"green"}},[e._v(e._s(o.fine)+"$")]):o.fine>0?a("a-tooltip",{attrs:{title:"Must first return.",color:"red"}},[a("a-tag",{attrs:{color:"red"}},[e._v(e._s(o.fine)+"$")])],1):e._e()],1)}}])})],1)},Q=[],M=[{title:"cover",dataIndex:"cover",needTotal:!0,scopedSlots:{customRender:"cover"}},{title:"Title",dataIndex:"book_name"},{title:"User id",dataIndex:"user_id"},{title:"Borrowing id",dataIndex:"borrowing_number"},{title:"Start time",dataIndex:"borrow_start_time"},{title:"Due time",dataIndex:"due_time"},{title:"Left fine",dataIndex:"fine",scopedSlots:{customRender:"fine"}},{title:"Barcode",scopedSlots:{customRender:"barcode"}}],U={name:"BookManage",components:{StandardTable:m["a"],VueBarcode:y.a},data:function(){return{loading2:!1,advanced:!0,columns:M,currentIndex:0,dataSource:[],selectedRows:[],loadingTable:!1,options:[],barcode:void 0,searchQuery:{}}},authorize:{deleteRecord:"delete"},methods:{deleteRecord:function(e){this.dataSource=this.dataSource.filter((function(t){return t.key!==e})),this.selectedRows=this.selectedRows.filter((function(t){return t.key!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced},onClear:function(){},onStatusTitleClick:function(){},onChange:function(){},onSelectChange:function(){},handleMenuClick:function(e){"delete"===e.key&&this.remove()},addBorrowing:function(){this.loadingTable=!0;var e=this,t=this.barcode,a=this.dataSource.filter((function(e){var a="".concat(e.ISBN,"/").concat(e.book_id);return a===t}));if(a.length>0)return this.loadingTable=!1,this.barcode=void 0,void this.$message.error("This barcode has been added.");fetch("".concat(this.$global.EXTRA_FUNCTION,"/borrowing?barcode=").concat(t)).then((function(e){return e.json()})).then((function(t){e.loadingTable=!1,console.log(111);var a=t.code,o=(t.msg,t.record);console.log(o),a<0?e.$message.error("Barcode not found or this book is not borrowed."):(o.key=o.ISBN,e.dataSource.push(o)),e.barcode=void 0})).catch((function(t){e.loadingTable=!1,e.$message.error("API call failed."),e.barcode=void 0}))},returnBooks:function(){if(this.loading2=!0,0!=this.selectedRows.length){var e,t=[],a=Object(_["a"])(this.selectedRows);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push("".concat(o.ISBN,"/").concat(o.book_id))}}catch(l){a.e(l)}finally{a.f()}var n=new Headers;n.append("Content-Type","application/json");var r=JSON.stringify({barcodes:t}),s={method:"POST",headers:n,body:r},c=this;fetch("".concat(this.$global.EXTRA_FUNCTION,"/return"),s).then((function(e){return e.text()})).then((function(e){c.loading2=!1,"success"===e?(c.$message.success("Successfully return."),c.barcode=void 0,c.dataSource=c.dataSource.filter((function(e){return-1===c.selectedRows.findIndex((function(t){return t.key===e.key}))})),c.selectedRows=[]):c.$message.error("Failed to return.")})).catch((function(e){return console.log("error",e)}))}else this.$message.error("No selected books.")},getCheckboxProps:function(e){return{props:{disabled:e.fine>0}}},showAll:function(){this.loadingTable=!0,this.dataSource=[];var e=this;fetch("".concat(this.$global.EXTRA_FUNCTION,"/getallborrowings")).then((function(e){return e.json()})).then((function(t){e.loadingTable=!1;var a=t.code,o=(t.msg,t.data);if(a<0)e.$message.error("No borrowed books!");else if(0==o.length)e.$message.error("No borrowed books!");else{var n,r=Object(_["a"])(o);try{for(r.s();!(n=r.n()).done;){var s=n.value;s.key=s.ISBN,e.dataSource.push(s)}}catch(c){r.e(c)}finally{r.f()}}e.barcode=void 0})).catch((function(t){e.loadingTable=!1,e.$message.error("API call failed."),e.barcode=void 0}))}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].getOptions();case 2:e.options=t.sent;case 3:case"end":return t.stop()}}),t)})))()}},L=U,K=(a("8eb7"),Object(d["a"])(L,$,Q,!1,null,"15741535",null)),F=K.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced},[a("a-form-item",{attrs:{label:"ID",labelCol:{span:7},wrapperCol:{span:10}}},[a("a-input",{attrs:{placeholder:"Please input id"},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1)],1),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.searchById}},[e._v("search")])],1)])],1),a("br"),a("div",[a("standard-table",{attrs:{loading:e.loading,columns:e.columns,dataSource:e.dataSource,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t},clear:e.onClear,change:e.onChange,selectedRowChange:e.onSelectChange},scopedSlots:e._u([{key:"barcode",fn:function(e){var t=e.record;return a("div",{staticStyle:{width:"250px"}},[a("vue-barcode",{staticStyle:{width:"100%"},attrs:{value:t.key+"/"+t.book_id}})],1)}},{key:"fine",fn:function(t){var o=t.record;return a("div",{},[a("a-tag",{attrs:{color:"red"}},[e._v(e._s(o.leftfine)+"$")])],1)}}])})],1)])},H=[],J=[{title:"id",dataIndex:"id"},{title:"name",dataIndex:"name"},{title:"Borrowing id",dataIndex:"borrowing_number"},{title:"Title",dataIndex:"book_name"},{title:"Start time",dataIndex:"borrow_start_time"},{title:"Due time",dataIndex:"due_time"},{title:"Left fine",dataIndex:"leftfine",scopedSlots:{customRender:"fine"}},{title:"Barcode",scopedSlots:{customRender:"barcode"}}],q={name:"FineManage",components:{StandardTable:m["a"],VueBarcode:y.a},data:function(){return{advanced:!0,columns:J,currentIndex:0,dataSource:[],selectedRows:[],loading:!1,options:[],barcode:void 0,searchQuery:{},id:""}},authorize:{deleteRecord:"delete"},methods:{deleteRecord:function(e){this.dataSource=this.dataSource.filter((function(t){return t.key!==e})),this.selectedRows=this.selectedRows.filter((function(t){return t.key!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced},onClear:function(){},onStatusTitleClick:function(){},onChange:function(){},onSelectChange:function(){},searchById:function(){var e=this.id.toString();console.log(e),this.dataSource=this.dataSource.filter((function(t){return t.id===e}))}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].getOptions();case 2:e.options=t.sent,e.loading=!0,a=new Headers,a.append("token",Object(c["c"])()),o={method:"GET",headers:a},n=e,fetch("".concat(e.$global.BASE_URL,"/api/admin/fine/detail?page_size=100&current_page=1"),o).then((function(e){return e.json()})).then((function(e){console.log(e),0==e.code||"0"==e.code?setTimeout((function(){var t,a=Object(_["a"])(e.data);try{for(a.s();!(t=a.n()).done;){var o=t.value;n.dataSource.push({id:o.id,name:o.name,borrowing_number:o.borrow_info.borrowingNumber,book_name:o.book_name,borrow_start_time:o.borrow_info.borrowStartTime,due_time:o.borrow_info.dueTime,leftfine:o.fine_info.amount,key:o.borrow_info.iSBN,book_id:o.borrow_info.bookId})}}catch(r){a.e(r)}finally{a.f()}n.loading=!1}),200):(n.$message.error("API call failed."),n.loading=!1)})).catch((function(e){n.loading=!1,n.$message.error("API call failed.")}));case 9:case"end":return t.stop()}}),t)})))()}},G=q,W=(a("f242"),Object(d["a"])(G,z,H,!1,null,"5bb35254",null)),V=W.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{class:e.advanced?"search":null},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:e.advanced?null:"fold"},[a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"Book name",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-input",{attrs:{placeholder:"Please input book name"},model:{value:e.searchQuery.book_name,callback:function(t){e.$set(e.searchQuery,"book_name",t)},expression:"searchQuery.book_name"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"Author",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-input",{attrs:{placeholder:"Please input author"},model:{value:e.searchQuery.author,callback:function(t){e.$set(e.searchQuery,"author",t)},expression:"searchQuery.author"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"Publisher",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Please input publisher"},model:{value:e.searchQuery.publisher,callback:function(t){e.$set(e.searchQuery,"publisher",t)},expression:"searchQuery.publisher"}})],1)],1)],1),e.advanced?a("a-row",[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"Publish date",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select publish date"},on:{change:e.onChange},model:{value:e.searchQuery.date,callback:function(t){e.$set(e.searchQuery,"date",t)},expression:"searchQuery.date"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"Book category",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-cascader",{attrs:{options:e.options,placeholder:"Please search for or select a book category","show-search":{filter:e.filter}}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"ISBN",labelCol:{span:8},wrapperCol:{span:15,offset:1}}},[a("a-input",{attrs:{placeholder:"Please input ISBN"}})],1)],1)],1):e._e()],1),a("span",{staticStyle:{float:"right","margin-top":"3px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("Search")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.resetQuery}},[e._v("Reset")]),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v(" "+e._s(e.advanced?"fold":"unfold")+" "),a("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)])],1),a("div",[a("standard-table",{attrs:{loading:e.loading,columns:e.columns,rowKey:function(e,t){return t},dataSource:e.dataSource,selectedRows:e.selectedRows},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t},clear:e.onClear,change:e.onChange,selectedRowChange:e.onSelectChange},scopedSlots:e._u([{key:"barcode",fn:function(e){var t=e.record;return a("div",{staticStyle:{width:"250px"}},[a("vue-barcode",{staticStyle:{width:"100%"},attrs:{value:t.ISBN}})],1)}},{key:"description",fn:function(t){var o=t.text;return a("div",{staticStyle:{width:"100px","font-size":"50%"}},[e._v(" "+e._s(o.slice(0,50))+"... ")])}},{key:"book_name",fn:function(t){var o=t.record;return a("div",{staticStyle:{width:"100px"}},[e._v(" 《"+e._s(o.book_name)+"》 ")])}},{key:"cover",fn:function(e){var t=e.record;return a("div",{},[a("img",{staticStyle:{width:"150px"},attrs:{slot:"avatar",size:"large",shape:"square",src:t.cover},slot:"avatar"})])}},{key:"reser_IDs",fn:function(t){var o=t.record;return a("div",{staticStyle:{width:"100px"}},e._l(o.reser_IDs,(function(t,o){return a("p",{key:o},[a("a-tag",{attrs:{color:"grey"}},[e._v(e._s(t))])],1)})),0)}},{key:"reser_status",fn:function(t){var o=t.record;return a("div",{staticStyle:{width:"100px"}},[1==o.reser_status?a("p",[a("a-tag",{attrs:{color:"pink"}},[e._v("reserved")])],1):a("p",[a("a-tag",{attrs:{color:"green"}},[e._v("not reserved")])],1)])}}])},[a("template",{slot:"statusTitle"},[a("a-icon",{attrs:{type:"info-circle"},nativeOn:{click:function(t){return e.onStatusTitleClick.apply(null,arguments)}}})],1)],2)],1)])},Y=[],Z=[{title:"cover",dataIndex:"cover",needTotal:!0,scopedSlots:{customRender:"cover"}},{title:"book name",dataIndex:"book_name",scopedSlots:{customRender:"book_name"}},{title:"reser status",dataIndex:"reser_status",scopedSlots:{customRender:"reser_status"}},{title:"reser number",dataIndex:"reser_number"},{title:"reser IDs",dataIndex:"reser_IDs",scopedSlots:{customRender:"reser_IDs"}},{title:"ISBN",dataIndex:"ISBN",sorter:!0,scopedSlots:{customRender:"barcode"}}],ee={name:"ReservationkManage",components:{StandardTable:m["a"],VueBarcode:y.a},data:function(){return{loading2:!1,advanced:!0,columns:Z,dataSource:[],reservationList:[],reservationConclusion:[],selectedRows:[],loading:!0,options:[],searchQuery:{book_name:"",author:"",publisher:"",ISBN:"",category:void 0,date:""}}},authorize:{deleteRecord:"delete"},methods:{deleteRecord:function(e){this.dataSource=this.dataSource.filter((function(t){return t.key!==e})),this.selectedRows=this.selectedRows.filter((function(t){return t.key!==e}))},toggleAdvanced:function(){this.advanced=!this.advanced},remove:function(){if(0!=this.selectedRows.length){this.loading=!0;var e,t=[],a=Object(_["a"])(this.selectedRows);try{for(a.s();!(e=a.n()).done;){var o=e.value;t.push(o.key)}}catch(i){a.e(i)}finally{a.f()}var n=new Headers;n.append("token",Object(c["c"])()),n.append("Content-Type","application/json");var r=JSON.stringify(t),s={method:"DELETE",headers:n,body:r},l=this;fetch("".concat(this.$global.BASE_URL,"/api/admin/book/delete"),s).then((function(e){return e.json()})).then((function(e){var t=e.code;e.msg,e.data;"0"===t||0===t?(l.$message.success("Delete books successfully."),l.dataSource=l.dataSource.filter((function(e){return-1===l.selectedRows.findIndex((function(t){return t.key===e.key}))}))):500==e.status&&l.$message.error("Fail to delete books. Please contact the manager."),l.selectedRows=[],l.loading=!1})).catch((function(e){l.selectedRows=[],l.$message.error("API call failed"),l.loading=!1}))}else this.$message.error("No selected books.")},onClear:function(){},onStatusTitleClick:function(){},onChange:function(){},onSelectChange:function(){},handleMenuClick:function(e){"delete"===e.key&&this.remove()},filter:function(e,t){return t.some((function(t){return t.label.toLowerCase().indexOf(e.toLowerCase())>-1}))},onChangeGategory:function(e,t){console.log(e,t)},getFormatCatgory:function(){return void 0===this.searchQuery.category||this.searchQuery.category===[]?"":this.searchQuery.category[0]},search:function(){var e=new Headers;e.append("token",Object(c["c"])());var t={method:"GET",headers:e};this.loading=!0;var a=this;fetch("".concat(this.$global.BASE_URL,"/api/book/search?book_name=").concat(this.searchQuery.book_name,"&author=").concat(this.searchQuery.author,"&publisher=").concat(this.searchQuery.publisher,"&ISBN=").concat(this.searchQuery.ISBN,"&category=").concat(this.getFormatCatgory(),"&pub_year=").concat(this.searchQuery.date?this.searchQuery.date.year():"","&pub_month=").concat(this.searchQuery.date?this.searchQuery.date.month():""),t).then((function(e){return e.json()})).then((function(e){0==e.code||"0"==e.code?setTimeout((function(){a.dataSource=[];var t,o=Object(_["a"])(e.data);try{for(o.s();!(t=o.n()).done;){var n=t.value;a.dataSource.push({key:n.ISBN,cover:n.cover,book_name:n.book_name,brief_introduction:n.brief_introduction+"",publisher:n.publisher,published_time:n.published_time,author:n.author,category:n.status})}}catch(r){o.e(r)}finally{o.f()}a.loading=!1}),200):(a.$messgae.error(e.msg),a.loading=!1)})).catch((function(e){a.$messgae.error("API call failed."),a.loading=!1}))},resetQuery:function(){this.searchQuery={book_name:"",author:"",publisher:"",ISBN:"",category:void 0,date:""}}},created:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].getOptions();case 2:e.options=t.sent,e.loading=!0,a=new Headers,a.append("token",Object(c["c"])()),o={method:"GET",headers:a},n=e,fetch("".concat(e.$global.BASE_URL,"/api/admin/reservations/detail"),o).then((function(e){return e.json()})).then((function(e){console.log("res:",e),0==e.code||"0"==e.code?setTimeout((function(){for(var t=0;t<e.data.length;t++){var a=e.data[t].book_info;n.dataSource.push({ISBN:a.iSBN,cover:a.cover,book_name:a.bookName,brief_introduction:a.brief_introduction+"",publisher:a.publisher,published_time:a.published_time,author:a.author,category:a.category,reser_IDs:e.data[t].reser_IDs.slice(0,5),reser_status:e.data[t].reser_status,reser_number:e.data[t].reser_number})}n.loading=!1}),200):n.loading=!1})).catch((function(e){console.log("error",e),n.loading=!1,n.$message.error("API call failed.")}));case 9:case"end":return t.stop()}}),t)})))()}},te=ee,ae=(a("f872"),Object(d["a"])(te,X,Y,!1,null,"5d7eb92c",null)),oe=ae.exports,ne={name:"Admin",data:function(){return{contentNumber:0,defaultSelectedKeys:["0"]}},components:{BookManage:x,UserManage:D,BorrowManage:F,FineManage:V,ReservationManage:oe,Dashboard:h},methods:{changeContent:function(e){this.contentNumber=e},onCollapse:function(e,t){console.log(e,t)},onBreakpoint:function(e){console.log(e)}},created:function(){var e=this.$route.query.tab;"user"==e&&(this.defaultSelectedKeys=["2"],this.contentNumber=2)}},re=ne,se=Object(d["a"])(re,o,n,!1,null,null,null);t["default"]=se.exports},d8da:function(e,t,a){e.exports=a.p+"img/lost_book.a35cc072.png"},e12b:function(e,t,a){},e81a:function(e,t,a){"use strict";a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var n=a("1da1"),r=(a("96cf"),a("e9c4"),[{value:"A",label:"A马克思主义、列宁主义、毛泽东思想、邓小平理论",children:[{value:"A",label:"全部"},{value:"A1",label:"A1马克思、恩格斯著作"},{value:"A2",label:"A2毛泽东著作"},{value:"A3",label:"A3马克思主义、列宁主义、毛泽东思想、邓小平理论的学习和研究"}]},{value:"B",label:"B哲学、宗教",children:[{value:"B",label:"全部"},{value:"B0",label:"B0哲学理论"},{value:"B81",label:"B81逻辑学"},{value:"B84",label:"B84心理学"}]},{value:"C",label:"C社会科学总论",children:[{value:"C",label:"全部"},{value:"C0",label:"C0社会科学理论与方法论"},{value:"C91",label:"C91社会学"},{value:"C8",label:"C8统计学"},{value:"C93",label:"C93管理学"}]},{value:"D",label:"D政治、法律",children:[{value:"D",label:"全部"},{value:"D2",label:"D2中国共产党"},{value:"D8",label:"D8外交、国际关系"},{value:"D9",label:"D9法律"}]},{value:"E",label:"E军事",children:[{value:"E",label:"全部"},{value:"E0",label:"E0军事理论"},{value:"E2",label:"E2中国军事"}]},{value:"F",label:"F经济",children:[{value:"F",label:"全部"},{value:"F0",label:"F0经济学"},{value:"F8",label:"F8财政、金融"}]},{value:"G",label:"G文化、科学、教育、体育",children:[{value:"G",label:"全部"},{value:"G4",label:"G4教育"},{value:"",label:"G8体育"}]},{value:"H",label:"H语言、文字",children:[{value:"H",label:"全部"},{value:"H0",label:"H0语言学"},{value:"H1",label:"H1汉语"},{value:"H3",label:"H3常用外国语"}]},{value:"I",label:"I文学",children:[{value:"I",label:"全部"},{value:"I1",label:"I1世界文学"},{value:"I2",label:"I2中国文学"}]},{value:"J",label:"J艺术",children:[{value:"J",label:"全部"},{value:"J2",label:"J2绘画"},{value:"J9",label:"J9电影、电视艺术"}]},{value:"K",label:"K历史、地理",children:[{value:"K",label:"全部"},{value:"K1",label:"K1世界史"},{value:"K2",label:"K2中国史"},{value:"K9",label:"K9地理"}]},{value:"N",label:"N自然科学总论",children:[{value:"N",label:"全部"},{value:"N0",label:"N0自然科学理论与方法论"}]},{value:"O",label:"O数理科学和化学",children:[{value:"O",label:"全部"},{value:"O1",label:"O1数学"},{value:"O4",label:"O4物理学"},{value:"O6",label:"O6化学"}]},{value:"P",label:"P天文学、地球科学",children:[{value:"P",label:"全部"},{value:"P1",label:"P1天文学"},{value:"P9",label:"P9自然地理学"}]},{value:"Q",label:"Q生物科学",children:[{value:"Q",label:"全部"},{value:"Q2",label:"Q2细胞生物学"},{value:"Q4",label:"Q4遗传学"},{value:"Q94",label:"Q94植物学"}]},{value:"R",label:"R医药、卫生",children:[{value:"R",label:"全部"},{value:"R3",label:"R3基础医学"},{value:"R4",label:"R4临床医学"},{value:"R9",label:"R9药学"}]},{value:"S",label:"S农业科学",children:[{value:"S",label:"全部"},{value:"S1",label:"S1农业基础科学"},{value:"S6",label:"S6园艺"}]},{value:"T",label:"T工业技术",children:[{value:"T",label:"全部"},{value:"TB",label:"TB一般工业技术"},{value:"TN",label:"TN无线电电子学、电信技术"},{value:"TP",label:"TP自动化技术、计算机技术"}]},{value:"U",label:"U交通运输",children:[{value:"U",label:"全部"},{value:"U2",label:"U2铁路运输"},{value:"U4",label:"U4公路运输"},{value:"U6",label:"U6水路运输"}]},{value:"V",label:"V航空、航天",children:[{value:"V",label:"全部"},{value:"V2",label:"V2航空"},{value:"V4",label:"V4航天"}]},{value:"X",label:"X环境科学、安全科学",children:[{value:"X",label:"全部"},{value:"X1",label:"X1环境科学基础理论"},{value:"X3",label:"X3环境保护管理"}]},{value:"Z",label:"Z综合类图书",children:[{value:"Z",label:"全部"}]}]),s=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=new Headers,t.append("Content-Type","application/json"),a=JSON.stringify({category:JSON.stringify(r)}),o={method:"POST",headers:t,body:a,redirect:"follow"},fetch("https://testip-cloud-homework-lralemfqco.cn-hangzhou.fcapp.run/editgory",o).then((function(e){return e.text()})).then((function(e){return console.log(e)})).catch((function(e){return console.log("error",e)}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("getOptions"),e.next=3,fetch("https://testip-cloud-homework-lralemfqco.cn-hangzhou.fcapp.run/category").then((function(e){return e.json()})).then((function(e){return JSON.parse(e.categoryString)}));case 3:return t=e.sent,console.log(o(t)),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t["a"]={getOptions:c,resetOptions:s}},f0e9:function(e,t,a){"use strict";a("50f5")},f242:function(e,t,a){"use strict";a("1ad2")},f325:function(e,t,a){e.exports=a.p+"img/fine.7af612ca.png"},f872:function(e,t,a){"use strict";a("619e")}}]);
//# sourceMappingURL=chunk-819bf8ea.a648489a.js.map